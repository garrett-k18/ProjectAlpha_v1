[build]
builder = "nixpacks"

[build.nixpacksPhase]
cmds = [
    "python -m pip install --upgrade pip",
    "pip install -r requirements.txt --no-cache-dir"
]

# NOTE: If you encounter stale cache issues, temporarily add --no-cache-dir to pip install
# or clear Railway cache: Railway Dashboard → Service → Settings → Clear Build Cache

[deploy]
startCommand = "python manage.py migrate && python manage.py collectstatic --noinput && gunicorn projectalphav1.wsgi:application --bind 0.0.0.0:$PORT"
healthcheckPath = "/api/"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

[deploy.envVars]
# Railway will use DATABASE_URL from your environment
DJANGO_SETTINGS_MODULE = "projectalphav1.settings"
PYTHONUNBUFFERED = "1"


